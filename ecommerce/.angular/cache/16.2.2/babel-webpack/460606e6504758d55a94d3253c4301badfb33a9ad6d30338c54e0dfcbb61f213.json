{"ast":null,"code":"var _class;\nimport { Command } from \"../models/command\";\nimport { CommandDetail } from \"../models/commanddetail\";\nimport { CartItem } from \"../models/cart-item\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../product.service\";\nimport * as i2 from \"../command.service\";\nimport * as i3 from \"../auth.service\";\nimport * as i4 from \"@angular/common\";\nfunction CommandsListComponent_div_8_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"div\", 12)(2, \"div\", 13)(3, \"div\");\n    i0.ɵɵelement(4, \"img\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 15)(6, \"h5\", 16);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"h4\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"div\", 17);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const detail_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", ctx_r2.productDetailsMap[detail_r3.product].thumbnail, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r2.productDetailsMap[detail_r3.product].title, \" Quantity : \", detail_r3.qte, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.productDetailsMap[detail_r3.product].price, \" $\");\n  }\n}\nfunction CommandsListComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8)(2, \"div\", 9)(3, \"h5\", 5);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(5, CommandsListComponent_div_8_div_5_Template, 11, 4, \"div\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const command_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.formatDate(command_r1.date));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", command_r1.details);\n  }\n}\nexport class CommandsListComponent {\n  constructor(productService, commandService, authService) {\n    this.productService = productService;\n    this.commandService = commandService;\n    this.authService = authService;\n    this.productDetailsMap = {};\n  }\n  ngOnInit() {\n    this.commandService.getCommandsById(this.authService.getAuthUser()).subscribe(response => {\n      this.parseCommands(response).then(commands => {\n        this.commands = commands;\n        this.commands.forEach(command => {\n          command.details.forEach(detail => {\n            this.getProductDetails(detail.product);\n          });\n        });\n      });\n    });\n  }\n  getProductDetails(productId) {\n    this.productService.getProductById(productId).subscribe(response => {\n      this.productDetailsMap[productId] = response;\n    });\n  }\n  parseCommands(response) {\n    return response.json().then(commandsData => {\n      const promises = commandsData.map(commandData => {\n        const detailsPromises = commandData.detailsCommandes.map(detailData => {\n          return this.productService.getProductById(detailData.product).toPromise().then(product => {\n            return new CommandDetail(new CartItem(product, detailData.qte));\n          });\n        });\n        return Promise.all(detailsPromises).then(details => {\n          return new Command(details, commandData.id, new Date(commandData.dateCommande));\n        });\n      });\n      return Promise.all(promises);\n    });\n  }\n  formatDate(date) {\n    // Implement your own logic to format the date as a string\n    return `${date.getDate()}-${date.getMonth() + 1}-${date.getFullYear()}`;\n  }\n}\n_class = CommandsListComponent;\n_class.ɵfac = function CommandsListComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.CommandService), i0.ɵɵdirectiveInject(i3.AuthService));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-commands-list\"]],\n  decls: 9,\n  vars: 1,\n  consts: [[1, \"row\", 2, \"display\", \"flex\", \"justify-content\", \"center\", \"align-items\", \"center\", \"height\", \"100vh\"], [1, \"col-xxl-8\", \"col-12\"], [1, \"card\"], [1, \"card-body\"], [1, \"mb-6\"], [1, \"mb-0\"], [\"class\", \"mb-8\", \"style\", \"margin-bottom: 100px\", 4, \"ngFor\", \"ngForOf\"], [1, \"mb-8\", 2, \"margin-bottom\", \"100px\"], [1, \"border-bottom\", \"mb-3\", \"pb-3\", \"d-lg-flex\", \"align-items-center\", \"justify-content-between\"], [1, \"d-flex\", \"align-items-center\", \"justify-content-between\"], [\"class\", \"row d-flex justify-content-between align-items-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"col-lg-8\", \"col-12\"], [1, \"d-md-flex\"], [\"alt\", \"Product Img\", 1, \"img-fluid\", \"rounded-3\", 2, \"max-height\", \"400px\", \"max-width\", \"400px\", 3, \"src\"], [1, \"ms-md-4\", \"mt-2\", \"mt-lg-0\"], [1, \"mb-1\"], [1, \"mt-3\"]],\n  template: function CommandsListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h4\", 5);\n      i0.ɵɵtext(6, \"Commandes\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(7, \"p\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(8, CommandsListComponent_div_8_Template, 6, 2, \"div\", 6);\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngForOf\", ctx.commands);\n    }\n  },\n  dependencies: [i4.NgForOf],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["Command","CommandDetail","CartItem","i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtext","ɵɵadvance","ɵɵproperty","ctx_r2","productDetailsMap","detail_r3","product","thumbnail","ɵɵsanitizeUrl","ɵɵtextInterpolate2","title","qte","ɵɵtextInterpolate1","price","ɵɵtemplate","CommandsListComponent_div_8_div_5_Template","ɵɵtextInterpolate","ctx_r0","formatDate","command_r1","date","details","CommandsListComponent","constructor","productService","commandService","authService","ngOnInit","getCommandsById","getAuthUser","subscribe","response","parseCommands","then","commands","forEach","command","detail","getProductDetails","productId","getProductById","json","commandsData","promises","map","commandData","detailsPromises","detailsCommandes","detailData","toPromise","Promise","all","id","Date","dateCommande","getDate","getMonth","getFullYear","ɵɵdirectiveInject","i1","ProductService","i2","CommandService","i3","AuthService","selectors","decls","vars","consts","template","CommandsListComponent_Template","rf","ctx","CommandsListComponent_div_8_Template"],"sources":["D:\\Studies\\Projects\\Angular\\ecommerce\\src\\app\\commands-list\\commands-list.component.ts","D:\\Studies\\Projects\\Angular\\ecommerce\\src\\app\\commands-list\\commands-list.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {ProductService} from \"../product.service\";\nimport {CommandService} from \"../command.service\";\nimport {Command} from \"../models/command\";\nimport {AuthService} from \"../auth.service\";\nimport {ProductItem} from \"../models/product-item\";\nimport {CommandDetail} from \"../models/commanddetail\";\nimport {CartItem} from \"../models/cart-item\";\n\n@Component({\n  selector: 'app-commands-list',\n  templateUrl: './commands-list.component.html',\n  styleUrls: ['./commands-list.component.css']\n})\nexport class CommandsListComponent implements OnInit{\n\n  commands: Command[] | undefined;\n\n  productDetailsMap: { [productId: number]: ProductItem } = {};\n  constructor(private productService : ProductService, private commandService : CommandService, private authService : AuthService) {\n  }\n\n  ngOnInit(): void {\n\n    this.commandService.getCommandsById(this.authService.getAuthUser()).subscribe(response => {\n      this.parseCommands(response).then((commands: Command[]) => {\n        this.commands = commands;\n\n        this.commands.forEach(command => {\n          command.details.forEach(detail => {\n            this.getProductDetails(detail.product);\n          });\n        });\n      });\n    });\n\n  }\n\n  getProductDetails(productId: number): void {\n    this.productService.getProductById(productId).subscribe(response => {\n      this.productDetailsMap[productId] = response;\n    });\n  }\n\n  parseCommands(response: Response): Promise<Command[]> {\n    return response.json().then((commandsData: any[]) => {\n      const promises = commandsData.map((commandData: any) => {\n        const detailsPromises = commandData.detailsCommandes.map((detailData: any) => {\n          return this.productService.getProductById(detailData.product).toPromise().then((product: any) => {\n            return new CommandDetail(new CartItem(product, detailData.qte));\n          });\n        });\n        return Promise.all(detailsPromises).then((details: CommandDetail[]) => {\n          return new Command(details, commandData.id, new Date(commandData.dateCommande));\n        });\n      });\n      return Promise.all(promises);\n    });\n  }\n\n  formatDate(date:any): string {\n    // Implement your own logic to format the date as a string\n    return `${date.getDate()}-${date.getMonth() + 1}-${date.getFullYear()}`;\n  }\n\n}\n","<div class=\"row\" style=\"display: flex; justify-content: center; align-items: center; height: 100vh\">\n  <div class=\"col-xxl-8 col-12\">\n    <!-- card -->\n    <div class=\"card\">\n      <!-- card body-->\n      <div class=\"card-body\">\n        <div class=\"mb-6\">\n          <h4 class=\"mb-0\">Commandes</h4>\n          <p></p>\n        </div>\n        <div class=\"mb-8\" *ngFor=\"let command of commands\" style=\"margin-bottom: 100px\">\n          <!-- Commande -->\n          <div class=\"border-bottom mb-3 pb-3 d-lg-flex align-items-center justify-content-between \">\n            <div class=\"d-flex align-items-center justify-content-between\">\n              <h5 class=\"mb-0\">{{formatDate(command.date)}}</h5> <!-- Command date + id? -->\n            </div>\n          </div>\n          <!-- details Commande -->\n          <div class=\"row d-flex justify-content-between align-items-center\" *ngFor=\"let detail of command.details\">\n            <!-- col -->\n            <div class=\"col-lg-8 col-12\">\n              <div class=\"d-md-flex\">\n                <div>\n                  <!-- img -->\n                  <img [src]=\"productDetailsMap[detail.product].thumbnail\" class=\"img-fluid rounded-3\" alt=\"Product Img\" style=\"max-height: 400px; max-width: 400px\">\n                </div>\n                <div class=\"ms-md-4 mt-2 mt-lg-0\">\n                  <!-- name + price -->\n                  <h5 class=\"mb-1\">\n                    {{productDetailsMap[detail.product].title}}\n                    Quantity : {{detail.qte}}\n                  </h5>\n                  <h4>{{productDetailsMap[detail.product].price}} $</h4>\n                  <div class=\"mt-3\">\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}