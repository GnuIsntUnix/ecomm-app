{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Command } from \"../models/command\";\nimport { CommandDetail } from \"../models/commanddetail\";\nimport { CartItem } from \"../models/cart-item\";\nexport let CommandsListComponent = class CommandsListComponent {\n  constructor(productService, commandService, authService) {\n    this.productService = productService;\n    this.commandService = commandService;\n    this.authService = authService;\n    this.productDetailsMap = {};\n  }\n  ngOnInit() {\n    this.commandService.getCommandsById(this.authService.getAuthUser()).subscribe(response => {\n      this.parseCommands(response).then(commands => {\n        this.commands = commands;\n        this.commands.forEach(command => {\n          command.details.forEach(detail => {\n            this.getProductDetails(detail.product);\n          });\n        });\n      });\n    });\n  }\n  getProductDetails(productId) {\n    this.productService.getProductById(productId).subscribe(response => {\n      this.productDetailsMap[productId] = response;\n    });\n  }\n  parseCommands(response) {\n    return response.json().then(commandsData => {\n      const promises = commandsData.map(commandData => {\n        const detailsPromises = commandData.detailsCommandes.map(detailData => {\n          return this.productService.getProductById(detailData.product).toPromise().then(product => {\n            return new CommandDetail(new CartItem(product, detailData.qte));\n          });\n        });\n        return Promise.all(detailsPromises).then(details => {\n          return new Command(details, commandData.id, new Date(commandData.dateCommande));\n        });\n      });\n      return Promise.all(promises);\n    });\n  }\n};\nCommandsListComponent = __decorate([Component({\n  selector: 'app-commands-list',\n  templateUrl: './commands-list.component.html',\n  styleUrls: ['./commands-list.component.css']\n})], CommandsListComponent);","map":{"version":3,"names":["Component","Command","CommandDetail","CartItem","CommandsListComponent","constructor","productService","commandService","authService","productDetailsMap","ngOnInit","getCommandsById","getAuthUser","subscribe","response","parseCommands","then","commands","forEach","command","details","detail","getProductDetails","product","productId","getProductById","json","commandsData","promises","map","commandData","detailsPromises","detailsCommandes","detailData","toPromise","qte","Promise","all","id","Date","dateCommande","__decorate","selector","templateUrl","styleUrls"],"sources":["D:\\Studies\\Projects\\Angular\\ecommerce\\src\\app\\commands-list\\commands-list.component.ts"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {ProductService} from \"../product.service\";\nimport {CommandService} from \"../command.service\";\nimport {Command} from \"../models/command\";\nimport {AuthService} from \"../auth.service\";\nimport {ProductItem} from \"../models/product-item\";\nimport {CommandDetail} from \"../models/commanddetail\";\nimport {CartItem} from \"../models/cart-item\";\n\n@Component({\n  selector: 'app-commands-list',\n  templateUrl: './commands-list.component.html',\n  styleUrls: ['./commands-list.component.css']\n})\nexport class CommandsListComponent implements OnInit{\n\n  commands: Command[] | undefined;\n\n  productDetailsMap: { [productId: number]: ProductItem } = {};\n  constructor(private productService : ProductService, private commandService : CommandService, private authService : AuthService) {\n  }\n\n  ngOnInit(): void {\n\n    this.commandService.getCommandsById(this.authService.getAuthUser()).subscribe(response => {\n      this.parseCommands(response).then((commands: Command[]) => {\n        this.commands = commands;\n\n        this.commands.forEach(command => {\n          command.details.forEach(detail => {\n            this.getProductDetails(detail.product);\n          });\n        });\n      });\n    });\n\n  }\n\n  getProductDetails(productId: number): void {\n    this.productService.getProductById(productId).subscribe(response => {\n      this.productDetailsMap[productId] = response;\n    });\n  }\n\n  parseCommands(response: Response): Promise<Command[]> {\n    return response.json().then((commandsData: any[]) => {\n      const promises = commandsData.map((commandData: any) => {\n        const detailsPromises = commandData.detailsCommandes.map((detailData: any) => {\n          return this.productService.getProductById(detailData.product).toPromise().then((product: any) => {\n            return new CommandDetail(new CartItem(product, detailData.qte));\n          });\n        });\n        return Promise.all(detailsPromises).then((details: CommandDetail[]) => {\n          return new Command(details, commandData.id, new Date(commandData.dateCommande));\n        });\n      });\n      return Promise.all(promises);\n    });\n  }\n\n}\n"],"mappings":";AAAA,SAAQA,SAAS,QAAe,eAAe;AAG/C,SAAQC,OAAO,QAAO,mBAAmB;AAGzC,SAAQC,aAAa,QAAO,yBAAyB;AACrD,SAAQC,QAAQ,QAAO,qBAAqB;AAOrC,WAAMC,qBAAqB,GAA3B,MAAMA,qBAAqB;EAKhCC,YAAoBC,cAA+B,EAAUC,cAA+B,EAAUC,WAAyB;IAA3G,KAAAF,cAAc,GAAdA,cAAc;IAA2B,KAAAC,cAAc,GAAdA,cAAc;IAA2B,KAAAC,WAAW,GAAXA,WAAW;IADjH,KAAAC,iBAAiB,GAAyC,EAAE;EAE5D;EAEAC,QAAQA,CAAA;IAEN,IAAI,CAACH,cAAc,CAACI,eAAe,CAAC,IAAI,CAACH,WAAW,CAACI,WAAW,EAAE,CAAC,CAACC,SAAS,CAACC,QAAQ,IAAG;MACvF,IAAI,CAACC,aAAa,CAACD,QAAQ,CAAC,CAACE,IAAI,CAAEC,QAAmB,IAAI;QACxD,IAAI,CAACA,QAAQ,GAAGA,QAAQ;QAExB,IAAI,CAACA,QAAQ,CAACC,OAAO,CAACC,OAAO,IAAG;UAC9BA,OAAO,CAACC,OAAO,CAACF,OAAO,CAACG,MAAM,IAAG;YAC/B,IAAI,CAACC,iBAAiB,CAACD,MAAM,CAACE,OAAO,CAAC;UACxC,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;EAEJ;EAEAD,iBAAiBA,CAACE,SAAiB;IACjC,IAAI,CAAClB,cAAc,CAACmB,cAAc,CAACD,SAAS,CAAC,CAACX,SAAS,CAACC,QAAQ,IAAG;MACjE,IAAI,CAACL,iBAAiB,CAACe,SAAS,CAAC,GAAGV,QAAQ;IAC9C,CAAC,CAAC;EACJ;EAEAC,aAAaA,CAACD,QAAkB;IAC9B,OAAOA,QAAQ,CAACY,IAAI,EAAE,CAACV,IAAI,CAAEW,YAAmB,IAAI;MAClD,MAAMC,QAAQ,GAAGD,YAAY,CAACE,GAAG,CAAEC,WAAgB,IAAI;QACrD,MAAMC,eAAe,GAAGD,WAAW,CAACE,gBAAgB,CAACH,GAAG,CAAEI,UAAe,IAAI;UAC3E,OAAO,IAAI,CAAC3B,cAAc,CAACmB,cAAc,CAACQ,UAAU,CAACV,OAAO,CAAC,CAACW,SAAS,EAAE,CAAClB,IAAI,CAAEO,OAAY,IAAI;YAC9F,OAAO,IAAIrB,aAAa,CAAC,IAAIC,QAAQ,CAACoB,OAAO,EAAEU,UAAU,CAACE,GAAG,CAAC,CAAC;UACjE,CAAC,CAAC;QACJ,CAAC,CAAC;QACF,OAAOC,OAAO,CAACC,GAAG,CAACN,eAAe,CAAC,CAACf,IAAI,CAAEI,OAAwB,IAAI;UACpE,OAAO,IAAInB,OAAO,CAACmB,OAAO,EAAEU,WAAW,CAACQ,EAAE,EAAE,IAAIC,IAAI,CAACT,WAAW,CAACU,YAAY,CAAC,CAAC;QACjF,CAAC,CAAC;MACJ,CAAC,CAAC;MACF,OAAOJ,OAAO,CAACC,GAAG,CAACT,QAAQ,CAAC;IAC9B,CAAC,CAAC;EACJ;CAED;AA9CYxB,qBAAqB,GAAAqC,UAAA,EALjCzC,SAAS,CAAC;EACT0C,QAAQ,EAAE,mBAAmB;EAC7BC,WAAW,EAAE,gCAAgC;EAC7CC,SAAS,EAAE,CAAC,+BAA+B;CAC5C,CAAC,C,EACWxC,qBAAqB,CA8CjC"},"metadata":{},"sourceType":"module","externalDependencies":[]}